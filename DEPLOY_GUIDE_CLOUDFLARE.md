# Cloudflare Tunnelì„ ì´ìš©í•œ ë°°í¬ ê°€ì´ë“œ (VPS ë˜ëŠ” ë‚´ PC)

Vercel ê°™ì€ ê³µìœ  ì„œë²„ì˜ í•œê³„ë¥¼ ë²—ì–´ë‚˜, **ë‚´ ì»´í“¨í„°(Local PC)**ë‚˜ **VPS(ê°œì¸ ì„œë²„)**ì—ì„œ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê³ , ì „ ì„¸ê³„ ì‚¬ëŒë“¤ì´ ì ‘ì†í•  ìˆ˜ ìˆê²Œ ë§Œë“œëŠ” ê°€ì¥ ì•ˆì „í•˜ê³  ì‰¬ìš´ ë°©ë²•ì€ **Cloudflare Tunnel**ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

ì´ ë°©ì‹ì€ íŒŒì¼ì„ ì–´ë”˜ê°€ë¡œ "ì—…ë¡œë“œ"í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, **ë‚´ ì»´í“¨í„°ì™€ Cloudflare ì‚¬ì´ì— ë¹„ë°€ í„°ë„ì„ ëš«ì–´ì„œ** ì—°ê²°í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

## 1. ì¤€ë¹„ë¬¼
1.  **ë„ë©”ì¸**: `mydomain.com` ê°™ì€ ê°œì¸ ë„ë©”ì¸ì´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤. (Cloudflareì— ë“±ë¡ë˜ì–´ ìˆì–´ì•¼ í•¨)
2.  **ì‹¤í–‰í•  ì»´í“¨í„°**: 24ì‹œê°„ ì¼œì ¸ ìˆëŠ” PC ë˜ëŠ” VPS (Ubuntu ë“±).

---

## 2. Cloudflare Tunnel ì„¤ì • (ì›¹ì—ì„œ í´ë¦­ë§Œìœ¼ë¡œ ê°€ëŠ¥)

1.  [Cloudflare One Dashboard](https://one.dash.cloudflare.com/)ì— ì ‘ì†í•©ë‹ˆë‹¤.
2.  **Networks** > **Tunnels** ë©”ë‰´ë¡œ ì´ë™í•©ë‹ˆë‹¤.
3.  **Create a Tunnel** ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
    *   Connector: **Cloudflared** ì„ íƒ.
    *   Name: ì›í•˜ëŠ” ì´ë¦„ ì…ë ¥ (ì˜ˆ: `roleplay-server`).
4.  **Install connector**:
    *   ìì‹ ì˜ ìš´ì˜ì²´ì œ(Windows, Mac, Debian/Ubuntu ë“±)ì— ë§ëŠ” ì„¤ì¹˜ ëª…ë ¹ì–´ê°€ ë‚˜ì˜µë‹ˆë‹¤.
    *   ì´ ëª…ë ¹ì–´ë¥¼ **ì‹¤í–‰í•  ì»´í“¨í„°(ë‚´ PC ë˜ëŠ” VPS)ì˜ í„°ë¯¸ë„**ì— ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ìŠµë‹ˆë‹¤.
    *   ì„¤ì¹˜ê°€ ì™„ë£Œë˜ë©´ ì›¹ í™”ë©´ í•˜ë‹¨ì— `Connected`ë¼ê³  ëœ¹ë‹ˆë‹¤.
5.  **Route Tunnel (ì—°ê²° ì„¤ì •)**:
    *   **Public Hostname**: ì›í•˜ëŠ” ì£¼ì†Œ ì…ë ¥ (ì˜ˆ: `roleplay` . `mydomain.com`).
    *   **Service**:
        *   Type: `HTTP`
        *   URL: `localhost:3000` (Next.jsê°€ ì‹¤í–‰ ì¤‘ì¸ ë¡œì»¬ ì£¼ì†Œ)
6.  **Save Tunnel** í´ë¦­.

ğŸ˜ **ëë‚¬ìŠµë‹ˆë‹¤!** ì´ì œ `https://roleplay.mydomain.com`ìœ¼ë¡œ ì ‘ì†í•˜ë©´ ë‚´ ì»´í“¨í„°ì˜ Next.js í™”ë©´ì´ ëœ¹ë‹ˆë‹¤.

---

## 3. ì„œë²„ì—ì„œ ì½”ë“œ ì‹¤í–‰í•˜ê¸° (VPS ê¸°ì¤€)

`Cloudflare Tunnel`ì€ ê¸¸ë§Œ ëš«ì–´ì¤„ ë¿, ì‹¤ì œ í”„ë¡œê·¸ë¨ì€ ë‚´ ì»´í“¨í„°ì—ì„œ ëŒì•„ê°€ê³  ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

### (1) ì½”ë“œ ê°€ì ¸ì˜¤ê¸° & ì„¤ì¹˜
```bash
# gitì´ ì—†ë‹¤ë©´ ì„¤ì¹˜
sudo apt update && sudo apt install git nodejs npm -y

# ì½”ë“œ ë³µì‚¬
git clone https://github.com/moonlitstoll/roleplay-generator.git
cd roleplay-generator

# ì„¤ì • íŒŒì¼ ìƒì„± (.env)
cp .env.example .env
nano .env # API í‚¤ ë“± ì…ë ¥ í›„ ì €ì¥ (Ctrl+O, Enter, Ctrl+X)

# ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ & ë¹Œë“œ
npm install
npm run build
```

### (2) ë°±ê·¸ë¼ìš´ë“œ ì‹¤í–‰ (PM2 ì‚¬ìš©)
í„°ë¯¸ë„ì„ êº¼ë„ ì„œë²„ê°€ ì£½ì§€ ì•Šê²Œ í•˜ë ¤ë©´ `pm2`ë¥¼ ì”ë‹ˆë‹¤.
```bash
# pm2 ì„¤ì¹˜
sudo npm install -g pm2

# ì„œë²„ ì‹¤í–‰ (ì´ë¦„ì„ 'roleplay'ë¡œ ì§€ì •)
pm2 start npm --name "roleplay" -- start

# (ì„ íƒì‚¬í•­) ì„œë²„ ì¬ë¶€íŒ… ì‹œ ìë™ ì‹¤í–‰ ì„¤ì •
pm2 startup
pm2 save
```

---

## 4. ì´ ë°©ì‹ì˜ ì¥ì 
1.  **ë¹„ìš© ì ˆì•½**: ì§‘ì— ë‚¨ëŠ” ë…¸íŠ¸ë¶ì´ë‚˜ PCë¥¼ ì“°ë©´ ì„œë²„ ë¹„ìš© 0ì›.
2.  **ì œí•œ ì—†ìŒ**: Vercelì˜ 10ì´ˆ íƒ€ì„ì•„ì›ƒ, ìš©ëŸ‰ ì œí•œ, IP ì°¨ë‹¨ ì´ìŠˆê°€ ì—†ìŠµë‹ˆë‹¤. (Edge TTS ì‚¬ìš© ê°€ëŠ¥!)
3.  **ë³´ì•ˆ**: ë‚´ IPê°€ ë…¸ì¶œë˜ì§€ ì•Šê³  Cloudflareê°€ ë””ë„ìŠ¤ ê³µê²©ì„ ë§‰ì•„ì¤ë‹ˆë‹¤. í¬íŠ¸í¬ì›Œë”© ê°™ì€ ë³µì¡í•œ ê³µìœ ê¸° ì„¤ì •ë„ í•„ìš” ì—†ìŠµë‹ˆë‹¤.
